(テーマ)ネットワークからデータを読みデコードする
================================================

実習内容
--------

* ネットワークから送られてくるデータをncコマンドを使ってセーブする。
* 送られてきたデータをncコマンドを使って読みデコードする。

エミュレータの起動とデータフォーマット
--------------------------------------

次のコマンドでエミュレータを起動する:

    % daqmw-tc-server -D

これでポート1234番で接続を待つようになる。

データフォーマットについてはすでに説明したとおり。

データをncコマンドを使ってセーブする
------------------------------------

TCPで送られてくるデータはLinux上でncコマンドで読むことが
できる:

    % nc 127.0.0.1 1234 > data

一定時間後(たとえば5秒後)に自動で停止させるにはtimeoutコマンドを
使うのが便利である:

    % timeout 5 nc 127.0.0.1 1234 > data

エミュレータはTCPで接続されるとすぐにデータを送るように組んである。
バイナリなのでcatコマンドで内容は表示することはできない。
xddコマンドで16進数ダンプで表示することができる。

    % xdd data

パイプで接続
------------

すでにファイルを読んでデコードするプログラムを書いたのでこれを
改造してパイプでつないでネットワークからデータを読んでデコードするように
改造する。

    % nc 127.0.0.1 1234 | ./decode_program

として起動するとncからの出力がdecode_programに標準入力として
入力される。標準入力のファイルハンドラはプログラム起動時に
すでにstdinとして使えるようになっている。

    FILE *fp;
    fp = fopen("data", "r");

となっていた部分(およびプログラム引数処理部分、fopen()エラー処理部分)を

    fp = stdin;

とすると標準入力を読むようになるのですでに書いたコードを変更し
試してみる。

~/daqmw-tc-network-2/bs/read_nc_decode/ に解答例がある。

---

[ex10](../ex10)
